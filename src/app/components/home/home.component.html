<div class="home-container">
  <!-- Header -->
  <header class="app-header">
    <div class="header-content">
      <h1>âŒ¨ï¸ DigitaFacil</h1>
      <p class="subtitle">{{ 'APP.SUBTITLE' | translate }}</p>
      <p class="user-name" *ngIf="currentUser">ğŸ‘¤ {{ currentUser.name }}</p>
    </div>
    <div class="header-actions">
      <div class="language-selector">
        <button class="header-button lang-btn" (click)="toggleLanguageSelector()" [title]="'HOME.CHANGE_LANGUAGE' | translate">
          {{ getCurrentLanguageFlag() }} ğŸŒ
        </button>
        <div class="language-dropdown" *ngIf="showLanguageSelector">
          <button 
            *ngFor="let lang of availableLanguages"
            class="lang-option"
            [class.active]="currentLanguage === lang.code"
            (click)="changeLanguage(lang.code)"
          >
            {{ lang.flag }} {{ lang.name }}
          </button>
        </div>
      </div>
      <button class="header-button" (click)="goToInstructions()">ğŸ“– {{ 'HOME.INSTRUCTIONS' | translate }}</button>
      <button class="header-button" (click)="goToStats()">ğŸ“Š {{ 'STATS.TITLE' | translate }}</button>
      <button class="header-button" (click)="goToSettings()">âš™ï¸ {{ 'SETTINGS.TITLE' | translate }}</button>
      <button class="header-button logout-btn" (click)="logout()" [title]="'HOME.LOGOUT' | translate">ğŸšª {{ 'HOME.LOGOUT' | translate }}</button>
    </div>
  </header>

  <!-- Progress Dashboard -->
  <div class="progress-dashboard" *ngIf="progress">
    <div class="progress-card">
      <div class="progress-stat">
        <div class="stat-icon">ğŸ¯</div>
        <div class="stat-content">
          <div class="stat-label">{{ 'HOME.YOUR_PROGRESS' | translate }}</div>
          <div class="stat-value">{{ getProgressPercentage() }}%</div>
        </div>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="getProgressPercentage()"></div>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-item">
        <div class="stat-icon">ğŸ“š</div>
        <div class="stat-content">
          <div class="stat-label">{{ 'HOME.COMPLETED_LESSONS' | translate }}</div>
          <div class="stat-value">{{ progress.completedLessons.length }}</div>
        </div>
      </div>

      <div class="stat-item">
        <div class="stat-icon">ğŸ†</div>
        <div class="stat-content">
          <div class="stat-label">{{ 'HOME.CURRENT_LEVEL' | translate }}</div>
          <div class="stat-value">{{ progress.level }}</div>
        </div>
      </div>

      <div class="stat-item">
        <div class="stat-icon">â­</div>
        <div class="stat-content">
          <div class="stat-label">{{ 'HOME.TOTAL_XP' | translate }}</div>
          <div class="stat-value">{{ progress.xp }}</div>
        </div>
      </div>

      <div class="stat-item">
        <div class="stat-icon">ğŸ”¥</div>
        <div class="stat-content">
          <div class="stat-label">{{ 'HOME.CURRENT_STREAK' | translate }}</div>
          <div class="stat-value">{{ progress.streak }} {{ 'HOME.DAYS' | translate }}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Level Filter -->
  <div class="filter-section">
    <h2>{{ 'HOME.AVAILABLE_LESSONS' | translate }}</h2>
    <div class="filter-buttons">
      <button 
        class="filter-button" 
        [class.active]="selectedLevel === 'all'"
        (click)="filterByLevel('all')"
      >
        {{ 'HOME.ALL' | translate }}
      </button>
      <button 
        class="filter-button" 
        [class.active]="selectedLevel === 'beginner'"
        [style.--level-color]="getLevelColor('beginner')"
        (click)="filterByLevel('beginner')"
      >
        {{ 'HOME.BEGINNER' | translate }}
      </button>
      <button 
        class="filter-button" 
        [class.active]="selectedLevel === 'intermediate'"
        [style.--level-color]="getLevelColor('intermediate')"
        (click)="filterByLevel('intermediate')"
      >
        {{ 'HOME.INTERMEDIATE' | translate }}
      </button>
      <button 
        class="filter-button" 
        [class.active]="selectedLevel === 'advanced'"
        [style.--level-color]="getLevelColor('advanced')"
        (click)="filterByLevel('advanced')"
      >
        {{ 'HOME.ADVANCED' | translate }}
      </button>
      <button 
        class="filter-button" 
        [class.active]="selectedLevel === 'expert'"
        [style.--level-color]="getLevelColor('expert')"
        (click)="filterByLevel('expert')"
      >
        {{ 'HOME.EXPERT' | translate }}
      </button>
    </div>
  </div>

  <!-- Lessons Grid -->
  <div class="lessons-grid">
    <div 
      *ngFor="let lesson of lessons" 
      class="lesson-card"
      [class.completed]="isLessonCompleted(lesson.id)"
      [class.locked]="isLessonLocked(lesson.id)"
      (click)="!isLessonLocked(lesson.id) && startLesson(lesson.id)"
    >
      <div class="lesson-number">
        <span *ngIf="!isLessonLocked(lesson.id) && !isLessonCompleted(lesson.id)">{{ lesson.id }}</span>
        <span *ngIf="isLessonCompleted(lesson.id)" class="completed-icon">âœ“</span>
        <span *ngIf="isLessonLocked(lesson.id)" class="locked-icon">ğŸ”’</span>
      </div>

      <div class="lesson-content">
        <h3>{{ lesson.title }}</h3>
        <p>{{ lesson.description }}</p>

        <div class="lesson-meta">
          <span class="level-badge" [style.background-color]="getLevelColor(lesson.level)">
            {{ getLevelLabel(lesson.level) }}
          </span>
          <span class="lesson-requirement">
            {{ lesson.minPPM }} PPM Â· {{ lesson.minAccuracy }}% {{ 'HOME.ACCURACY' | translate }}
          </span>
        </div>
      </div>

      <div class="lesson-action">
        <button 
          class="start-button" 
          *ngIf="!isLessonLocked(lesson.id)"
          [class.resume]="!isLessonCompleted(lesson.id)"
        >
          {{ isLessonCompleted(lesson.id) ? ('HOME.CONTINUE' | translate) : ('HOME.START' | translate) }}
        </button>
      </div>
    </div>
  </div>
</div>
