<div class="stats-container">
  <!-- Header -->
  <div class="stats-header">
    <button class="back-button" (click)="goBack()">â† Voltar</button>
    <h1>ğŸ“Š Suas EstatÃ­sticas</h1>
    <p>Acompanhe seu progresso e desempenho</p>
  </div>

  <!-- Main Stats -->
  <div class="main-stats" *ngIf="stats">
    <div class="stat-card highlight">
      <div class="stat-icon">âš¡</div>
      <div class="stat-info">
        <div class="stat-label">Melhor PPM</div>
        <div class="stat-value">{{ stats.bestPPM }}</div>
        <div class="stat-desc">{{ getPerformanceRating(stats.bestPPM) }}</div>
      </div>
    </div>

    <div class="stat-card highlight">
      <div class="stat-icon">ğŸ¯</div>
      <div class="stat-info">
        <div class="stat-label">Melhor PrecisÃ£o</div>
        <div class="stat-value">{{ stats.bestAccuracy }}%</div>
        <div class="stat-desc">{{ getAccuracyRating(stats.bestAccuracy) }}</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">ğŸ“ˆ</div>
      <div class="stat-info">
        <div class="stat-label">WPM MÃ©dio</div>
        <div class="stat-value">{{ stats.averagePPM }}</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">âœ¨</div>
      <div class="stat-info">
        <div class="stat-label">PrecisÃ£o MÃ©dia</div>
        <div class="stat-value">{{ stats.averageAccuracy }}%</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">âŒ¨ï¸</div>
      <div class="stat-info">
        <div class="stat-label">Total de Teclas</div>
        <div class="stat-value">{{ stats.totalKeystrokes.toLocaleString() }}</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">ğŸ“š</div>
      <div class="stat-info">
        <div class="stat-label">SessÃµes Totais</div>
        <div class="stat-value">{{ stats.totalSessions }}</div>
      </div>
    </div>
  </div>

  <!-- Errors by Key -->
  <div class="errors-section" *ngIf="errorsByKeyArray.length > 0">
    <h2>ğŸ¯ Teclas com Mais Erros</h2>
    <p class="section-desc">Foque nestas teclas para melhorar sua precisÃ£o</p>
    
    <div class="errors-list">
      <div class="error-item" *ngFor="let error of errorsByKeyArray; let i = index">
        <div class="error-rank">{{ i + 1 }}</div>
        <div class="error-key">{{ error.key }}</div>
        <div class="error-bar-container">
          <div 
            class="error-bar" 
            [style.width.%]="(error.count / errorsByKeyArray[0].count) * 100"
          ></div>
        </div>
        <div class="error-count">{{ error.count }} erros</div>
      </div>
    </div>
  </div>

  <!-- Session History -->
  <div class="history-section" *ngIf="sessionHistory.length > 0">
    <h2>ğŸ“œ HistÃ³rico Recente</h2>
    <p class="section-desc">Ãšltimas sessÃµes de treino</p>
    
    <div class="history-list">
      <div 
        class="history-item" 
        *ngFor="let session of sessionHistory"
        [class.completed]="session.completed"
      >
        <div class="history-date">
          <div class="date-day">{{ formatDate(session.date).split(' ')[0] }}</div>
          <div class="date-time">{{ formatDate(session.date).split(' ')[1] }}</div>
        </div>

        <div class="history-details">
          <div class="history-title">LiÃ§Ã£o {{ session.lessonId }}</div>
          <div class="history-meta">
            <span>{{ session.metrics.ppm }} PPM</span>
            <span>â€¢</span>
            <span>{{ session.metrics.accuracy }}% precisÃ£o</span>
            <span>â€¢</span>
            <span>{{ formatDuration(session.duration) }}</span>
          </div>
        </div>

        <div class="history-status">
          <span class="status-badge" [class.success]="session.completed">
            {{ session.completed ? 'âœ“ Completo' : 'â—‹ Praticado' }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!stats || stats.totalSessions === 0">
    <div class="empty-icon">ğŸ“Š</div>
    <h3>Ainda nÃ£o hÃ¡ estatÃ­sticas</h3>
    <p>Complete algumas liÃ§Ãµes para ver suas estatÃ­sticas aparecerem aqui!</p>
    <button class="action-button" (click)="goBack()">ComeÃ§ar a Praticar</button>
  </div>
</div>
